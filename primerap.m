if te>=1
    for k=3:n-1
      for j=-2:0
        rd(1,j+3,k-1)=fn_norma([p(k).x,p(k).y],[p(j+k).x,p(j+k).y]);
        d(1,j+3,k-1)=-te*((p(k).x-p(k+j).x)/((((rd(1,j+3,k-1))^2)+1)^(1/2)));
        dxp(j+3)=[0];
      end
    end 
 % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%    derivatives Stencil 1                                    %                                                                                                           
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

for k=2
      for j=-1:0
        rdl(1,j+2,k-1)=fn_norma([p(k).x,p(k).y],[p(j+k).x,p(j+k).y]);
        dl(1,j+2,k-1)=-te*((p(k).x-p(k+j).x)/((((rdl(1,j+2,k-1))^2)+1)^(1/2)));
        dxpl(j+2)=[0];
      end
end    
end

if te<1
   for k=2:n-2
      for j=0:2
        rd(1,j+1,k)=fn_norma([p(k).x,p(k).y],[p(j+k).x,p(j+k).y]);
        d(1,j+1,k)=-te*((p(k).x-p(k+j).x)/((((rd(1,j+1,k))^2)+1)^(1/2)));
        dxp(j+1)=[0];
      end
end 

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%    derivatives Stencil n                                    %                                                                                                           
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

for k=n-1
      for j=0:1
        rdl(1,j+1,2)=fn_norma([p(k).x,p(k).y],[p(j+k).x,p(j+k).y]);
        dl(1,j+1,2)=-te*((p(k).x-p(k+j).x)/((((rdl(1,j+1,2))^2)+1)^(1/2)));
        dxpl(j+1)=[0];
      end
end 

end